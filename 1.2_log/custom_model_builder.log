auc_roc() missing 3 required positional arguments: 'self', 'y_true_local', and 'y_pred_local'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 114, in build_and_compile
    metrics_list.append(customized_metrics.auc_roc())
TypeError: auc_roc() missing 3 required positional arguments: 'self', 'y_true_local', and 'y_pred_local'
Can't instantiate abstract class customized_metrics_auc_roc with abstract methods result, update_state
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 114, in build_and_compile
    metrics_list.append(customized_metrics_auc_roc())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\metrics.py", line 154, in __new__
    obj = super(Metric, cls).__new__(cls)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\version_utils.py", line 58, in __new__
    return super(LayerVersionSelector, cls).__new__(cls)
TypeError: Can't instantiate abstract class customized_metrics_auc_roc with abstract methods result, update_state
('Keyword argument not understood:', 'stride')
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 151, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_1, kernel_size=(kernel_size_y_1, kernel_size_x_1),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 582, in __init__
    super(Conv2D, self).__init__(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 121, in __init__
    super(Conv, self).__init__(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 456, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 294, in __init__
    generic_utils.validate_kwargs(kwargs, allowed_kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py", line 792, in validate_kwargs
    raise TypeError(error_message, kwarg)
TypeError: ('Keyword argument not understood:', 'stride')
('Keyword argument not understood:', 'stride')
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 153, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_1, kernel_size=(kernel_size_y_1, kernel_size_x_1),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 582, in __init__
    super(Conv2D, self).__init__(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 121, in __init__
    super(Conv, self).__init__(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 456, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 294, in __init__
    generic_utils.validate_kwargs(kwargs, allowed_kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py", line 792, in validate_kwargs
    raise TypeError(error_message, kwarg)
TypeError: ('Keyword argument not understood:', 'stride')
add() got an unexpected keyword argument 'activity_regularizer_dense_layer_4'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 184, in build_and_compile
    classifier_.add(layers.Dense(units_dense_layer_4, activation=activation_dense_layer_4),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 456, in _method_wrapper
    result = method(self, *args, **kwargs)
TypeError: add() got an unexpected keyword argument 'activity_regularizer_dense_layer_4'
add() got an unexpected keyword argument 'activity_regularizer'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 184, in build_and_compile
    classifier_.add(layers.Dense(units_dense_layer_4, activation=activation_dense_layer_4),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 456, in _method_wrapper
    result = method(self, *args, **kwargs)
TypeError: add() got an unexpected keyword argument 'activity_regularizer'
'property' object is not iterable
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 190, in build_and_compile
    classifier_.compile(optimizer=optimizer_function, loss=losses_list, metrics=metrics_list)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 325, in compile
    self._validate_compile(optimizer, metrics, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 1598, in _validate_compile
    for v in getattr(metric, 'variables', []):
TypeError: 'property' object is not iterable
This model has not yet been built. Build the model first by calling `build()` or calling `fit()` with some data, or specify an `input_shape` argument in the first layer(s) for automatic build.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 192, in build_and_compile
    classifier_.summary()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\network.py", line 1346, in summary
    raise ValueError('This model has not yet been built. '
ValueError: This model has not yet been built. Build the model first by calling `build()` or calling `fit()` with some data, or specify an `input_shape` argument in the first layer(s) for automatic build.
Input 0 of layer conv2d is incompatible with the layer: expected ndim=4, found ndim=3. Full shape received: [512, 512, 3]
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 189, in build_and_compile
    classifier_.build(input_shape=(input_shape_y, input_shape_x, nof_channels))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 266, in build
    super(Sequential, self).build(input_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\network.py", line 685, in build
    self.call(x, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 291, in call
    outputs = layer(inputs, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 885, in __call__
    input_spec.assert_input_compatibility(self.input_spec, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_spec.py", line 176, in assert_input_compatibility
    raise ValueError('Input ' + str(input_index) + ' of layer ' +
ValueError: Input 0 of layer conv2d is incompatible with the layer: expected ndim=4, found ndim=3. Full shape received: [512, 512, 3]
Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_2/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_1/Identity, conv2d_2/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,32], [3,3,32,32].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1654, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_2/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_1/Identity, conv2d_2/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,32], [3,3,32,32].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 169, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_3,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 456, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 213, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 922, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 207, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1106, in __call__
    return self.conv_op(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 638, in __call__
    return self.call(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 231, in __call__
    return self.conv_op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2006, in conv2d
    return gen_nn_ops.conv2d(input,  # pylint: disable=redefined-builtin
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 965, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 593, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3319, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1816, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1657, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_2/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_1/Identity, conv2d_2/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,32], [3,3,32,32].
Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_2/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_1/Identity, conv2d_2/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,32], [3,3,32,32].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1654, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_2/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_1/Identity, conv2d_2/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,32], [3,3,32,32].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 169, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_3,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 456, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 213, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 922, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 207, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1106, in __call__
    return self.conv_op(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 638, in __call__
    return self.call(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 231, in __call__
    return self.conv_op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2006, in conv2d
    return gen_nn_ops.conv2d(input,  # pylint: disable=redefined-builtin
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 965, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 593, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3319, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1816, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1657, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_2/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_1/Identity, conv2d_2/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,32], [3,3,32,32].
Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,32], [3,3,32,32].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1654, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,32], [3,3,32,32].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 176, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_4,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 456, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 213, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 922, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 207, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1106, in __call__
    return self.conv_op(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 638, in __call__
    return self.call(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 231, in __call__
    return self.conv_op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2006, in conv2d
    return gen_nn_ops.conv2d(input,  # pylint: disable=redefined-builtin
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 965, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 593, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3319, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1816, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1657, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,32], [3,3,32,32].
categorical_crossentropy() missing 2 required positional arguments: 'y_true' and 'y_pred'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 108, in build_and_compile
    losses_list.append(losses.categorical_crossentropy())
TypeError: categorical_crossentropy() missing 2 required positional arguments: 'y_true' and 'y_pred'
categorical_hinge() missing 2 required positional arguments: 'y_true' and 'y_pred'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 110, in build_and_compile
    losses_list.append(losses.categorical_hinge())
TypeError: categorical_hinge() missing 2 required positional arguments: 'y_true' and 'y_pred'
OOM when allocating tensor with shape[516128,2048] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:Mul]
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 205, in build_and_compile
    classifier_.add(layers.Dense(units_dense_layer_4, activation=activation_dense_layer_4,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 456, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 213, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 897, in __call__
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2416, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1158, in build
    self.kernel = self.add_weight(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 560, in add_weight
    variable = self._add_variable_with_custom_getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 738, in _add_variable_with_custom_getter
    new_variable = getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer_utils.py", line 129, in make_variable
    return tf_variables.VariableV1(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 259, in __call__
    return cls._variable_v1_call(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 205, in _variable_v1_call
    return previous_getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 198, in <lambda>
    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variable_scope.py", line 2584, in default_variable_creator
    return resource_variable_ops.ResourceVariable(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 263, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 1423, in __init__
    self._init_from_args(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 1567, in _init_from_args
    initial_value() if init_from_fn else initial_value,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer_utils.py", line 121, in <lambda>
    init_val = lambda: initializer(shape, dtype=dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\init_ops_v2.py", line 558, in __call__
    return self._random_generator.random_uniform(shape, -limit, limit, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\init_ops_v2.py", line 1067, in random_uniform
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\random_ops.py", line 301, in random_uniform
    result = math_ops.add(result * (maxval - minval), minval, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 984, in binary_op_wrapper
    return func(x, y, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 1283, in _mul_dispatch
    return gen_math_ops.mul(x, y, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_math_ops.py", line 6089, in mul
    _ops.raise_from_not_ok_status(e, name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[516128,2048] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:Mul]
If using `weights` as `"imagenet"` with `include_top` as true, `classes` should be 1000
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 225, in build_and_compile
    classifier_ = tf.keras.applications.EfficientNetB2(include_top=True, weights='imagenet',
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 579, in EfficientNetB2
    return EfficientNet(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 279, in EfficientNet
    raise ValueError('If using `weights` as `"imagenet"` with `include_top`'
ValueError: If using `weights` as `"imagenet"` with `include_top` as true, `classes` should be 1000
'metrics_1'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 230, in build_and_compile
    metrics=local_hyperparameters['metrics_1'])
KeyError: 'metrics_1'
name 'kwargs' is not defined
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 188, in build_and_compile
    depthwise_constraint=None, bias_constraint=None, **kwargs))
NameError: name 'kwargs' is not defined
add() got an unexpected keyword argument 'kernel_initializer'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 180, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_1, kernel_size=(kernel_size_y_1, kernel_size_x_1),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
TypeError: add() got an unexpected keyword argument 'kernel_initializer'
add() got an unexpected keyword argument 'kernel_initializer'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 233, in build_and_compile
    classifier_.add(layers.Dense(units_dense_layer_4, activation=activation_dense_layer_4,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
TypeError: add() got an unexpected keyword argument 'kernel_initializer'
Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/cond/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,4], [3,3,4,4].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/cond/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,4], [3,3,4,4].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 228, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_4,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 251, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1014, in convolution_v2
    return convolution_internal(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1144, in convolution_internal
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2588, in _conv2d_expanded_batch
    return gen_nn_ops.conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 976, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 3 from 2 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/cond/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,2,2,4], [3,3,4,4].
Negative dimension size caused by subtracting 2 from 1 for '{{node average_pooling2d_1/AvgPool}} = AvgPool[T=DT_FLOAT, data_format="NHWC", ksize=[1, 2, 2, 1], padding="VALID", strides=[1, 2, 2, 1]](batch_normalization_5/cond/Identity)' with input shapes: [?,1,1,4].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 2 from 1 for '{{node average_pooling2d_1/AvgPool}} = AvgPool[T=DT_FLOAT, data_format="NHWC", ksize=[1, 2, 2, 1], padding="VALID", strides=[1, 2, 2, 1]](batch_normalization_5/cond/Identity)' with input shapes: [?,1,1,4].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 236, in build_and_compile
    classifier_.add(layers.AvgPool2D(pool_size=(pool_size_y_4, pool_size_x_4)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\pooling.py", line 295, in call
    outputs = self.pool_function(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 4281, in avg_pool
    return gen_nn_ops.avg_pool(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 84, in avg_pool
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 2 from 1 for '{{node average_pooling2d_1/AvgPool}} = AvgPool[T=DT_FLOAT, data_format="NHWC", ksize=[1, 2, 2, 1], padding="VALID", strides=[1, 2, 2, 1]](batch_normalization_5/cond/Identity)' with input shapes: [?,1,1,4].
Negative dimension size caused by subtracting 2 from 1 for '{{node average_pooling2d_1/AvgPool}} = AvgPool[T=DT_FLOAT, data_format="NHWC", ksize=[1, 2, 2, 1], padding="VALID", strides=[1, 2, 2, 1]](batch_normalization_4/cond/Identity)' with input shapes: [?,1,1,4].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 2 from 1 for '{{node average_pooling2d_1/AvgPool}} = AvgPool[T=DT_FLOAT, data_format="NHWC", ksize=[1, 2, 2, 1], padding="VALID", strides=[1, 2, 2, 1]](batch_normalization_4/cond/Identity)' with input shapes: [?,1,1,4].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 236, in build_and_compile
    classifier_.add(layers.AvgPool2D(pool_size=(pool_size_y_4, pool_size_x_4)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\pooling.py", line 295, in call
    outputs = self.pool_function(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 4281, in avg_pool
    return gen_nn_ops.avg_pool(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 84, in avg_pool
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 2 from 1 for '{{node average_pooling2d_1/AvgPool}} = AvgPool[T=DT_FLOAT, data_format="NHWC", ksize=[1, 2, 2, 1], padding="VALID", strides=[1, 2, 2, 1]](batch_normalization_4/cond/Identity)' with input shapes: [?,1,1,4].
Negative dimension size caused by subtracting 4 from 3 for '{{node conv2d_1/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout/cond/Identity, conv2d_1/Conv2D/ReadVariableOp)' with input shapes: [?,3,3,16], [4,4,16,8].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 4 from 3 for '{{node conv2d_1/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout/cond/Identity, conv2d_1/Conv2D/ReadVariableOp)' with input shapes: [?,3,3,16], [4,4,16,8].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 204, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_2,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 251, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1014, in convolution_v2
    return convolution_internal(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1144, in convolution_internal
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2588, in _conv2d_expanded_batch
    return gen_nn_ops.conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 976, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 4 from 3 for '{{node conv2d_1/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout/cond/Identity, conv2d_1/Conv2D/ReadVariableOp)' with input shapes: [?,3,3,16], [4,4,16,8].
Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/cond/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,4], [3,3,4,4].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/cond/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,4], [3,3,4,4].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 226, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_4,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 251, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1014, in convolution_v2
    return convolution_internal(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1144, in convolution_internal
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2588, in _conv2d_expanded_batch
    return gen_nn_ops.conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 976, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/cond/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,4], [3,3,4,4].
Unknown activation function: Relu
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 186, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_1, kernel_size=(kernel_size_y_1, kernel_size_x_1),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 665, in __init__
    activation=activations.get(activation),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\activations.py", line 529, in get
    return deserialize(identifier)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\activations.py", line 488, in deserialize
    return deserialize_keras_object(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py", line 377, in deserialize_keras_object
    raise ValueError(
ValueError: Unknown activation function: Relu
swish() missing 1 required positional argument: 'x'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 215, in build_and_compile
    classifier_.add(tf.keras.activations.swish())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
TypeError: swish() missing 1 required positional argument: 'x'
('Keyword argument not understood:', 'pool_size')
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 216, in build_and_compile
    classifier_.add(layers.GlobalAveragePooling2D(pool_size=(pool_size_y_4, pool_size_x_4)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\pooling.py", line 862, in __init__
    super(GlobalPooling2D, self).__init__(**kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 318, in __init__
    generic_utils.validate_kwargs(kwargs, allowed_kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py", line 778, in validate_kwargs
    raise TypeError(error_message, kwarg)
TypeError: ('Keyword argument not understood:', 'pool_size')
add() got an unexpected keyword argument 'kernel_initializer'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 235, in build_and_compile
    classifier_.add(layers.Dense(units_final_layer, activation=activation_final_layer),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
TypeError: add() got an unexpected keyword argument 'kernel_initializer'
__init__() got multiple values for argument 'kernel_size'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
TypeError: __init__() got multiple values for argument 'kernel_size'
__init__() got multiple values for argument 'kernel_size'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
TypeError: __init__() got multiple values for argument 'kernel_size'
__init__() got multiple values for argument 'kernel_size'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
TypeError: __init__() got multiple values for argument 'kernel_size'
__init__() got multiple values for argument 'kernel_size'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
TypeError: __init__() got multiple values for argument 'kernel_size'
Negative dimension size caused by subtracting 64 from 63 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,63,63,64], [64,64,64,1].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 64 from 63 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,63,63,64], [64,64,64,1].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 2401, in call
    outputs = backend.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 5363, in depthwise_conv2d
    x = nn.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 860, in depthwise_conv2d
    return nn_ops.with_space_to_batch(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 572, in with_space_to_batch
    return new_op(input, None)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 743, in __call__
    return self.call(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 562, in <lambda>
    return lambda inp, _: op(inp, num_spatial_dims, padding)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 852, in op
    return nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2832, in depthwise_conv2d_native
    return gen_nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 2227, in depthwise_conv2d_native
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 64 from 63 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,63,63,64], [64,64,64,1].
Negative dimension size caused by subtracting 64 from 63 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,63,63,64], [64,64,64,1].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 64 from 63 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,63,63,64], [64,64,64,1].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 2401, in call
    outputs = backend.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 5363, in depthwise_conv2d
    x = nn.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 860, in depthwise_conv2d
    return nn_ops.with_space_to_batch(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 572, in with_space_to_batch
    return new_op(input, None)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 743, in __call__
    return self.call(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 562, in <lambda>
    return lambda inp, _: op(inp, num_spatial_dims, padding)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 852, in op
    return nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2832, in depthwise_conv2d_native
    return gen_nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 2227, in depthwise_conv2d_native
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 64 from 63 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,63,63,64], [64,64,64,1].
Negative dimension size caused by subtracting 32 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,64], [32,32,64,1].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 32 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,64], [32,32,64,1].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 2401, in call
    outputs = backend.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 5363, in depthwise_conv2d
    x = nn.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 860, in depthwise_conv2d
    return nn_ops.with_space_to_batch(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 572, in with_space_to_batch
    return new_op(input, None)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 743, in __call__
    return self.call(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 562, in <lambda>
    return lambda inp, _: op(inp, num_spatial_dims, padding)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 852, in op
    return nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2832, in depthwise_conv2d_native
    return gen_nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 2227, in depthwise_conv2d_native
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 32 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,64], [32,32,64,1].
Negative dimension size caused by subtracting 32 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,128], [32,32,128,1].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 32 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,128], [32,32,128,1].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 2401, in call
    outputs = backend.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 5363, in depthwise_conv2d
    x = nn.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 860, in depthwise_conv2d
    return nn_ops.with_space_to_batch(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 572, in with_space_to_batch
    return new_op(input, None)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 743, in __call__
    return self.call(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 562, in <lambda>
    return lambda inp, _: op(inp, num_spatial_dims, padding)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 852, in op
    return nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2832, in depthwise_conv2d_native
    return gen_nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 2227, in depthwise_conv2d_native
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 32 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,128], [32,32,128,1].
Negative dimension size caused by subtracting 64 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,256], [64,64,256,1].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 64 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,256], [64,64,256,1].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 2401, in call
    outputs = backend.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 5363, in depthwise_conv2d
    x = nn.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 860, in depthwise_conv2d
    return nn_ops.with_space_to_batch(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 572, in with_space_to_batch
    return new_op(input, None)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 743, in __call__
    return self.call(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 562, in <lambda>
    return lambda inp, _: op(inp, num_spatial_dims, padding)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 852, in op
    return nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2832, in depthwise_conv2d_native
    return gen_nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 2227, in depthwise_conv2d_native
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 64 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,256], [64,64,256,1].
Negative dimension size caused by subtracting 128 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,128], [128,128,128,1].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 128 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,128], [128,128,128,1].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 2401, in call
    outputs = backend.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 5363, in depthwise_conv2d
    x = nn.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 860, in depthwise_conv2d
    return nn_ops.with_space_to_batch(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 572, in with_space_to_batch
    return new_op(input, None)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 743, in __call__
    return self.call(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 562, in <lambda>
    return lambda inp, _: op(inp, num_spatial_dims, padding)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 852, in op
    return nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2832, in depthwise_conv2d_native
    return gen_nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 2227, in depthwise_conv2d_native
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 128 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,128], [128,128,128,1].
Negative dimension size caused by subtracting 128 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,128], [128,128,128,1].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 128 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,128], [128,128,128,1].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 196, in build_and_compile
    classifier_.add(layers.DepthwiseConv2D(units_layer_2,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 2401, in call
    outputs = backend.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 5363, in depthwise_conv2d
    x = nn.depthwise_conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 860, in depthwise_conv2d
    return nn_ops.with_space_to_batch(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 572, in with_space_to_batch
    return new_op(input, None)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 743, in __call__
    return self.call(inp, filter)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 562, in <lambda>
    return lambda inp, _: op(inp, num_spatial_dims, padding)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_impl.py", line 852, in op
    return nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2832, in depthwise_conv2d_native
    return gen_nn_ops.depthwise_conv2d_native(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 2227, in depthwise_conv2d_native
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 128 from 31 for '{{node depthwise_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](dropout/cond/Identity, depthwise_conv2d/depthwise/ReadVariableOp)' with input shapes: [?,31,31,128], [128,128,128,1].
Unknown activation function: Relu
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 225, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_4,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 665, in __init__
    activation=activations.get(activation),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\activations.py", line 529, in get
    return deserialize(identifier)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\activations.py", line 488, in deserialize
    return deserialize_keras_object(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py", line 377, in deserialize_keras_object
    raise ValueError(
ValueError: Unknown activation function: Relu
Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,16], [3,3,16,16].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,16], [3,3,16,16].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 247, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_3,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 251, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1014, in convolution_v2
    return convolution_internal(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1144, in convolution_internal
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2588, in _conv2d_expanded_batch
    return gen_nn_ops.conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 976, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,16], [3,3,16,16].
Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [3,3,8,8].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [3,3,8,8].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 247, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_3,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 251, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1014, in convolution_v2
    return convolution_internal(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1144, in convolution_internal
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2588, in _conv2d_expanded_batch
    return gen_nn_ops.conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 976, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [3,3,8,8].
Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [3,3,8,8].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [3,3,8,8].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 247, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_3,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 251, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1014, in convolution_v2
    return convolution_internal(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1144, in convolution_internal
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2588, in _conv2d_expanded_batch
    return gen_nn_ops.conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 976, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [3,3,8,8].
Negative dimension size caused by subtracting 4 from 1 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/cond/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [4,4,8,8].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 4 from 1 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/cond/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [4,4,8,8].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 226, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_2, kernel_size=(kernel_size_y_2, kernel_size_x_2),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 251, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1014, in convolution_v2
    return convolution_internal(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1144, in convolution_internal
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2588, in _conv2d_expanded_batch
    return gen_nn_ops.conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 976, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 4 from 1 for '{{node conv2d_3/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_2/cond/Identity, conv2d_3/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [4,4,8,8].
Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [3,3,8,8].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [3,3,8,8].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 247, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_3,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 251, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1014, in convolution_v2
    return convolution_internal(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1144, in convolution_internal
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2588, in _conv2d_expanded_batch
    return gen_nn_ops.conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 976, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 3 from 1 for '{{node conv2d_5/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_4/cond/Identity, conv2d_5/Conv2D/ReadVariableOp)' with input shapes: [?,1,1,8], [3,3,8,8].
Negative dimension size caused by subtracting 8 from 7 for '{{node conv2d_2/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_1/cond/Identity, conv2d_2/Conv2D/ReadVariableOp)' with input shapes: [?,7,7,16], [8,8,16,8].
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1838, in _create_c_op
    c_op = pywrap_tf_session.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 8 from 7 for '{{node conv2d_2/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_1/cond/Identity, conv2d_2/Conv2D/ReadVariableOp)' with input shapes: [?,7,7,16], [8,8,16,8].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 216, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_2, kernel_size=(kernel_size_y_2, kernel_size_x_2),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 251, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1014, in convolution_v2
    return convolution_internal(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 1144, in convolution_internal
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\nn_ops.py", line 2588, in _conv2d_expanded_batch
    return gen_nn_ops.conv2d(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_nn_ops.py", line 976, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 742, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 591, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 3509, in _create_op_internal
    ret = Operation(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 2000, in __init__
    self._c_op = _create_c_op(self._graph, node_def, inputs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1841, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 8 from 7 for '{{node conv2d_2/Conv2D}} = Conv2D[T=DT_FLOAT, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true](dropout_1/cond/Identity, conv2d_2/Conv2D/ReadVariableOp)' with input shapes: [?,7,7,16], [8,8,16,8].
name 'customized_loss' is not defined
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 142, in build_and_compile
    losses_list.append(customized_loss())
NameError: name 'customized_loss' is not defined
OOM when allocating tensor with shape[537832008,512] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:RandomUniform]
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 272, in build_and_compile
    classifier_.add(layers.Dense(units_dense_layer_4, activation=activation_dense_layer_4,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1171, in build
    self.kernel = self.add_weight(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 597, in add_weight
    variable = self._add_variable_with_custom_getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 747, in _add_variable_with_custom_getter
    new_variable = getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer_utils.py", line 133, in make_variable
    return tf_variables.VariableV1(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 260, in __call__
    return cls._variable_v1_call(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 206, in _variable_v1_call
    return previous_getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 199, in <lambda>
    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variable_scope.py", line 2587, in default_variable_creator
    return resource_variable_ops.ResourceVariable(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 264, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 1509, in __init__
    self._init_from_args(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 1653, in _init_from_args
    initial_value() if init_from_fn else initial_value,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\initializers\initializers_v2.py", line 397, in __call__
    return super(VarianceScaling, self).__call__(shape, dtype=_get_dtype(dtype))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\init_ops_v2.py", line 561, in __call__
    return self._random_generator.random_uniform(shape, -limit, limit, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\init_ops_v2.py", line 1043, in random_uniform
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\random_ops.py", line 301, in random_uniform
    result = gen_random_ops.random_uniform(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_random_ops.py", line 727, in random_uniform
    _ops.raise_from_not_ok_status(e, name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 6879, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[537832008,512] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:RandomUniform]
OOM when allocating tensor with shape[537832008,512] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:RandomUniform]
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 272, in build_and_compile
    classifier_.add(layers.Dense(units_dense_layer_4, activation=activation_dense_layer_4,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1171, in build
    self.kernel = self.add_weight(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 597, in add_weight
    variable = self._add_variable_with_custom_getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 747, in _add_variable_with_custom_getter
    new_variable = getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer_utils.py", line 133, in make_variable
    return tf_variables.VariableV1(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 260, in __call__
    return cls._variable_v1_call(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 206, in _variable_v1_call
    return previous_getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 199, in <lambda>
    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variable_scope.py", line 2587, in default_variable_creator
    return resource_variable_ops.ResourceVariable(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 264, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 1509, in __init__
    self._init_from_args(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 1653, in _init_from_args
    initial_value() if init_from_fn else initial_value,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\initializers\initializers_v2.py", line 397, in __call__
    return super(VarianceScaling, self).__call__(shape, dtype=_get_dtype(dtype))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\init_ops_v2.py", line 561, in __call__
    return self._random_generator.random_uniform(shape, -limit, limit, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\init_ops_v2.py", line 1043, in random_uniform
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\random_ops.py", line 301, in random_uniform
    result = gen_random_ops.random_uniform(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_random_ops.py", line 727, in random_uniform
    _ops.raise_from_not_ok_status(e, name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 6879, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[537832008,512] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:RandomUniform]
OOM when allocating tensor with shape[537832008,512] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:RandomUniform]
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 272, in build_and_compile
    classifier_.add(layers.Dense(units_dense_layer_4, activation=activation_dense_layer_4,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1171, in build
    self.kernel = self.add_weight(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 597, in add_weight
    variable = self._add_variable_with_custom_getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 747, in _add_variable_with_custom_getter
    new_variable = getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer_utils.py", line 133, in make_variable
    return tf_variables.VariableV1(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 260, in __call__
    return cls._variable_v1_call(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 206, in _variable_v1_call
    return previous_getter(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 199, in <lambda>
    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variable_scope.py", line 2587, in default_variable_creator
    return resource_variable_ops.ResourceVariable(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\variables.py", line 264, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 1509, in __init__
    self._init_from_args(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 1653, in _init_from_args
    initial_value() if init_from_fn else initial_value,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\initializers\initializers_v2.py", line 397, in __call__
    return super(VarianceScaling, self).__call__(shape, dtype=_get_dtype(dtype))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\init_ops_v2.py", line 561, in __call__
    return self._random_generator.random_uniform(shape, -limit, limit, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\init_ops_v2.py", line 1043, in random_uniform
    return op(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\random_ops.py", line 301, in random_uniform
    result = gen_random_ops.random_uniform(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_random_ops.py", line 727, in random_uniform
    _ops.raise_from_not_ok_status(e, name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 6879, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[537832008,512] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:RandomUniform]
('Keyword argument not understood:', 'pading')
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 207, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_1, kernel_size=(kernel_size_y_1, kernel_size_x_1),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 656, in __init__
    super(Conv2D, self).__init__(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\convolutional.py", line 137, in __init__
    super(Conv, self).__init__(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 318, in __init__
    generic_utils.validate_kwargs(kwargs, allowed_kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\generic_utils.py", line 778, in validate_kwargs
    raise TypeError(error_message, kwarg)
TypeError: ('Keyword argument not understood:', 'pading')
'Functional' object has no attribute 'add'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 311, in build_and_compile
    classifier_.add(layers.GlobalMaxPooling2D())
AttributeError: 'Functional' object has no attribute 'add'
Attempt to convert a value (<tensorflow.python.keras.layers.pooling.GlobalMaxPooling2D object at 0x000001FEE53622E0>) with an unsupported type (<class 'tensorflow.python.keras.layers.pooling.GlobalMaxPooling2D'>) to a Tensor.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 311, in build_and_compile
    classifier_(layers.GlobalMaxPooling2D())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\functional.py", line 385, in call
    return self._run_internal_graph(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\functional.py", line 508, in _run_internal_graph
    outputs = node.layer(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\preprocessing\image_preprocessing.py", line 329, in call
    return math_ops.cast(inputs, dtype) * scale + offset
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 923, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1525, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 339, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 264, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 276, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 98, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Attempt to convert a value (<tensorflow.python.keras.layers.pooling.GlobalMaxPooling2D object at 0x000001FEE53622E0>) with an unsupported type (<class 'tensorflow.python.keras.layers.pooling.GlobalMaxPooling2D'>) to a Tensor.
'Functional' object has no attribute 'build_model'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 311, in build_and_compile
    classifier_.build_model()(layers.GlobalMaxPooling2D())
AttributeError: 'Functional' object has no attribute 'build_model'
build() missing 1 required positional argument: 'input_shape'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 311, in build_and_compile
    classifier_.build()(layers.GlobalMaxPooling2D())
TypeError: build() missing 1 required positional argument: 'input_shape'
'NoneType' object is not callable
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 311, in build_and_compile
    classifier_.build(input_shape=(input_shape_y, input_shape_x, nof_channels))(layers.GlobalMaxPooling2D())
TypeError: 'NoneType' object is not callable
'Functional' object has no attribute 'add'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 312, in build_and_compile
    classifier_.add(layers.GlobalMaxPooling2D())
AttributeError: 'Functional' object has no attribute 'add'
Attempt to convert a value (<tensorflow.python.keras.layers.pooling.GlobalMaxPooling2D object at 0x000002DF066F3340>) with an unsupported type (<class 'tensorflow.python.keras.layers.pooling.GlobalMaxPooling2D'>) to a Tensor.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 312, in build_and_compile
    classifier_(layers.GlobalMaxPooling2D())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\functional.py", line 385, in call
    return self._run_internal_graph(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\functional.py", line 508, in _run_internal_graph
    outputs = node.layer(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\preprocessing\image_preprocessing.py", line 329, in call
    return math_ops.cast(inputs, dtype) * scale + offset
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 923, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1525, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 339, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 264, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 276, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 98, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Attempt to convert a value (<tensorflow.python.keras.layers.pooling.GlobalMaxPooling2D object at 0x000002DF066F3340>) with an unsupported type (<class 'tensorflow.python.keras.layers.pooling.GlobalMaxPooling2D'>) to a Tensor.
add() got an unexpected keyword argument 'kernel_initializer'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 314, in build_and_compile
    effnb2_model.add(layers.Dense(units_final_layer, activation=activation_final_layer),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
TypeError: add() got an unexpected keyword argument 'kernel_initializer'
The last dimension of the inputs to `Dense` should be defined. Found `None`.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 313, in build_and_compile
    effnb2_model.add(layers.Dense(units_final_layer, activation=activation_final_layer,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1168, in build
    raise ValueError('The last dimension of the inputs to `Dense` '
ValueError: The last dimension of the inputs to `Dense` should be defined. Found `None`.
The last dimension of the inputs to `Dense` should be defined. Found `None`.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 314, in build_and_compile
    effnb2_model.add(layers.Dense(units_final_layer, activation=activation_final_layer,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1168, in build
    raise ValueError('The last dimension of the inputs to `Dense` '
ValueError: The last dimension of the inputs to `Dense` should be defined. Found `None`.
The last dimension of the inputs to `Dense` should be defined. Found `None`.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 313, in build_and_compile
    effnb2_model.add(layers.Dense(units_dense_layer_4, activation=activation_dense_layer_4))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1168, in build
    raise ValueError('The last dimension of the inputs to `Dense` '
ValueError: The last dimension of the inputs to `Dense` should be defined. Found `None`.
The last dimension of the inputs to `Dense` should be defined. Found `None`.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 312, in build_and_compile
    effnb2_model.add(layers.Dense(units_dense_layer_4, activation=activation_dense_layer_4))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1168, in build
    raise ValueError('The last dimension of the inputs to `Dense` '
ValueError: The last dimension of the inputs to `Dense` should be defined. Found `None`.
The last dimension of the inputs to `Dense` should be defined. Found `None`.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 312, in build_and_compile
    effnb2_model.add(layers.Dense(units_dense_layer_4, activation=activation_dense_layer_4,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1168, in build
    raise ValueError('The last dimension of the inputs to `Dense` '
ValueError: The last dimension of the inputs to `Dense` should be defined. Found `None`.
The last dimension of the inputs to `Dense` should be defined. Found `None`.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 312, in build_and_compile
    effnb2_model.add(layers.Dense(units_final_layer, activation=activation_final_layer,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1168, in build
    raise ValueError('The last dimension of the inputs to `Dense` '
ValueError: The last dimension of the inputs to `Dense` should be defined. Found `None`.
'Functional' object has no attribute 'add'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 312, in build_and_compile
    classifier_.add(layers.Dense(units=units_final_layer,
AttributeError: 'Functional' object has no attribute 'add'
The last dimension of the inputs to `Dense` should be defined. Found `None`.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 312, in build_and_compile
    effnb2_model.add(layers.Dense(units=units_final_layer,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1168, in build
    raise ValueError('The last dimension of the inputs to `Dense` '
ValueError: The last dimension of the inputs to `Dense` should be defined. Found `None`.
The last dimension of the inputs to `Dense` should be defined. Found `None`.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 313, in build_and_compile
    effnb2_model.add(layers.Dense(units=units_final_layer, activation=activation_final_layer))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1168, in build
    raise ValueError('The last dimension of the inputs to `Dense` '
ValueError: The last dimension of the inputs to `Dense` should be defined. Found `None`.
Input 0 of layer global_max_pooling1d is incompatible with the layer: expected ndim=3, found ndim=4. Full shape received: [None, None, None, 1408]
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 311, in build_and_compile
    effnb2_model.add(layers.GlobalMaxPool1D())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1093, in _functional_construction_call
    input_spec.assert_input_compatibility(self.input_spec, inputs, self.name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_spec.py", line 183, in assert_input_compatibility
    raise ValueError('Input ' + str(input_index) + ' of layer ' +
ValueError: Input 0 of layer global_max_pooling1d is incompatible with the layer: expected ndim=3, found ndim=4. Full shape received: [None, None, None, 1408]
The last dimension of the inputs to `Dense` should be defined. Found `None`.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 312, in build_and_compile
    effnb2_model.add(layers.Dense(units=1408, activation=activation_final_layer))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1099, in _functional_construction_call
    self._maybe_build(inputs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2648, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1168, in build
    raise ValueError('The last dimension of the inputs to `Dense` '
ValueError: The last dimension of the inputs to `Dense` should be defined. Found `None`.
Input 0 of layer global_max_pooling1d is incompatible with the layer: expected ndim=3, found ndim=4. Full shape received: [None, None, None, 1408]
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 311, in build_and_compile
    effnb2_model.add(layers.GlobalMaxPool1D())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1093, in _functional_construction_call
    input_spec.assert_input_compatibility(self.input_spec, inputs, self.name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_spec.py", line 183, in assert_input_compatibility
    raise ValueError('Input ' + str(input_index) + ' of layer ' +
ValueError: Input 0 of layer global_max_pooling1d is incompatible with the layer: expected ndim=3, found ndim=4. Full shape received: [None, None, None, 1408]
You are trying to load a weight file containing 2 layers into a model with 185 layers.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 297, in build_and_compile
    classifier_ = tf.keras.applications.EfficientNetB2(include_top=False, weights=pretrained_weights,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 579, in EfficientNetB2
    return EfficientNet(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 409, in EfficientNet
    model.load_weights(weights)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 684, in load_weights_from_hdf5_group
    raise ValueError('You are trying to load a weight file '
ValueError: You are trying to load a weight file containing 2 layers into a model with 185 layers.
'Functional' object has no attribute 'add'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 302, in build_and_compile
    classifier_.add(layers.Conv2D(units_layer_2, kernel_size=(kernel_size_y_2, kernel_size_x_2),
AttributeError: 'Functional' object has no attribute 'add'
Shapes (3,) and (3, 3, 3, 32) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 313, in build_and_compile
    classifier_.load_weights(pretrained_weights)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (3,) and (3, 3, 3, 32) are incompatible
You are trying to load a weight file containing 2 layers into a model with 185 layers.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 296, in build_and_compile
    classifier_.load_weights(pretrained_weights)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 684, in load_weights_from_hdf5_group
    raise ValueError('You are trying to load a weight file '
ValueError: You are trying to load a weight file containing 2 layers into a model with 185 layers.
Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 315, in build_and_compile
    classifier_.load_weights(pretrained_weights)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Could not interpret initializer identifier: -0.477121254719
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 313, in build_and_compile
    effnb2_model.add(layers.Dense(units_final_layer, activation=activation_final_layer,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\core.py", line 1150, in __init__
    self.bias_initializer = initializers.get(bias_initializer)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\initializers\__init__.py", line 161, in get
    raise ValueError('Could not interpret initializer identifier: ' +
ValueError: Could not interpret initializer identifier: -0.477121254719
Can't instantiate abstract class customized_metrics_bacc with abstract methods result, update_state
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 165, in build_and_compile
    metrics_list.append(customized_metrics_bacc())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\metrics.py", line 163, in __new__
    obj = super(Metric, cls).__new__(cls)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\version_utils.py", line 66, in __new__
    return super(LayerVersionSelector, cls).__new__(cls)
TypeError: Can't instantiate abstract class customized_metrics_bacc with abstract methods result, update_state
'property' object is not iterable
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 322, in build_and_compile
    effnb2_model.compile(optimizer=optimizer_function, loss=losses_list, metrics=metrics_list)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 538, in compile
    self._validate_compile(optimizer, metrics, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2525, in _validate_compile
    for v in getattr(metric, 'variables', []):
TypeError: 'property' object is not iterable
Can't instantiate abstract class customized_metrics_bacc with abstract methods result, update_state
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 172, in build_and_compile
    metrics_list.append(customized_metrics_bacc())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\metrics.py", line 163, in __new__
    obj = super(Metric, cls).__new__(cls)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\version_utils.py", line 66, in __new__
    return super(LayerVersionSelector, cls).__new__(cls)
TypeError: Can't instantiate abstract class customized_metrics_bacc with abstract methods result, update_state
Can't instantiate abstract class customized_metrics_bacc with abstract methods result, update_state
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 172, in build_and_compile
    metrics_list.append([customized_metrics_bacc()])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\metrics.py", line 163, in __new__
    obj = super(Metric, cls).__new__(cls)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\version_utils.py", line 66, in __new__
    return super(LayerVersionSelector, cls).__new__(cls)
TypeError: Can't instantiate abstract class customized_metrics_bacc with abstract methods result, update_state
LossScaleOptimizer does not support wrapping optimizers with a clipnorm. Optimizer <tensorflow.python.keras.optimizer_v2.adam.Adam object at 0x000002B0CEE815E0> has clipnorm 1.0
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 137, in build_and_compile
    optimizer_function = tf.train.experimental.enable_mixed_precision_graph_rewrite(optimizer_function)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 205, in enable_mixed_precision_graph_rewrite
    return _enable_mixed_precision_graph_rewrite_base(opt, loss_scale,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 345, in _enable_mixed_precision_graph_rewrite_base
    opt = _wrap_optimizer(opt, loss_scale, use_v1_behavior=use_v1_behavior)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 54, in _wrap_optimizer
    return wrapper_cls(opt, loss_scale)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\mixed_precision\experimental\loss_scale_optimizer.py", line 252, in __init__
    raise ValueError('LossScaleOptimizer does not support wrapping '
ValueError: LossScaleOptimizer does not support wrapping optimizers with a clipnorm. Optimizer <tensorflow.python.keras.optimizer_v2.adam.Adam object at 0x000002B0CEE815E0> has clipnorm 1.0
LossScaleOptimizer does not support wrapping optimizers with a clipvalue. Optimizer <tensorflow.python.keras.optimizer_v2.adam.Adam object at 0x000001DA40F105E0> has clipvalue 5.0
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 137, in build_and_compile
    optimizer_function = tf.train.experimental.enable_mixed_precision_graph_rewrite(optimizer_function)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 205, in enable_mixed_precision_graph_rewrite
    return _enable_mixed_precision_graph_rewrite_base(opt, loss_scale,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 345, in _enable_mixed_precision_graph_rewrite_base
    opt = _wrap_optimizer(opt, loss_scale, use_v1_behavior=use_v1_behavior)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 54, in _wrap_optimizer
    return wrapper_cls(opt, loss_scale)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\mixed_precision\experimental\loss_scale_optimizer.py", line 257, in __init__
    raise ValueError('LossScaleOptimizer does not support wrapping '
ValueError: LossScaleOptimizer does not support wrapping optimizers with a clipvalue. Optimizer <tensorflow.python.keras.optimizer_v2.adam.Adam object at 0x000001DA40F105E0> has clipvalue 5.0
Can't instantiate abstract class OptimizerV2 with abstract methods get_config
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 144, in build_and_compile
    optimizer_function = customized_optimizer(optimizer_function, clipnorm)
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 49, in customized_optimizer
    return optimizers.Optimizer(opt_func, clipnorm=clip_norm)
TypeError: Can't instantiate abstract class OptimizerV2 with abstract methods get_config
LossScaleOptimizer does not support wrapping optimizers with a clipnorm. Optimizer <tensorflow.python.keras.optimizer_v2.adam.Adam object at 0x0000012E7BBF05E0> has clipnorm 1.0
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 140, in build_and_compile
    optimizer_function = tf.train.experimental.enable_mixed_precision_graph_rewrite(optimizer_function)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 205, in enable_mixed_precision_graph_rewrite
    return _enable_mixed_precision_graph_rewrite_base(opt, loss_scale,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 345, in _enable_mixed_precision_graph_rewrite_base
    opt = _wrap_optimizer(opt, loss_scale, use_v1_behavior=use_v1_behavior)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 54, in _wrap_optimizer
    return wrapper_cls(opt, loss_scale)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\mixed_precision\experimental\loss_scale_optimizer.py", line 252, in __init__
    raise ValueError('LossScaleOptimizer does not support wrapping '
ValueError: LossScaleOptimizer does not support wrapping optimizers with a clipnorm. Optimizer <tensorflow.python.keras.optimizer_v2.adam.Adam object at 0x0000012E7BBF05E0> has clipnorm 1.0
Unable to open file (unable to open file: name = 'check_point__7_layers_CNN__group_0_loss_-0.9996-.hdf5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 346, in build_and_compile
    classifier_.load_weights(local_settings['use_local_pretrained_weights_for_retraining'])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2211, in load_weights
    with h5py.File(filepath, 'r') as f:
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\h5py\_hl\files.py", line 406, in __init__
    fid = make_fid(name, mode, userblock_size,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\h5py\_hl\files.py", line 173, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py\_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py\_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py\h5f.pyx", line 88, in h5py.h5f.open
OSError: Unable to open file (unable to open file: name = 'check_point__7_layers_CNN__group_0_loss_-0.9996-.hdf5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 346, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 346, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Shapes (3,) and (3, 3, 3, 32) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 346, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (3,) and (3, 3, 3, 32) are incompatible
'Functional' object is not subscriptable
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 348, in build_and_compile
    print(classifier_.layers[0][-1])
TypeError: 'Functional' object is not subscriptable
Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 345, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 345, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 345, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (1, 1, 2112, 352) and (3, 3, 3, 32) are incompatible
Unsuccessful TensorSliceReader constructor: Failed to find any matching files for ./5.0_MODELS_DIR/None
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\py_checkpoint_reader.py", line 95, in NewCheckpointReader
    return CheckpointReader(compat.as_bytes(filepattern))
RuntimeError: Unsuccessful TensorSliceReader constructor: Failed to find any matching files for ./5.0_MODELS_DIR/None

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 345, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2183, in load_weights
    py_checkpoint_reader.NewCheckpointReader(filepath)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\py_checkpoint_reader.py", line 99, in NewCheckpointReader
    error_translator(e)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\py_checkpoint_reader.py", line 35, in error_translator
    raise errors_impl.NotFoundError(None, None, error_message)
tensorflow.python.framework.errors_impl.NotFoundError: Unsuccessful TensorSliceReader constructor: Failed to find any matching files for ./5.0_MODELS_DIR/None
Shapes (3, 3, 3, 32) and (3,) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 345, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (3, 3, 3, 32) and (3,) are incompatible
A merge layer should be called on a list of inputs.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 315, in build_and_compile
    classifier_.add(layer)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\merge.py", line 122, in call
    raise ValueError('A merge layer should be called on a list of inputs.')
ValueError: A merge layer should be called on a list of inputs.
'list' object has no attribute 'add'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 315, in build_and_compile
    classifier_.add(layer)
AttributeError: 'list' object has no attribute 'add'
'InputLayer' object has no attribute 'layers'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 315, in build_and_compile
    classifier_.add(layer.layers)
AttributeError: 'InputLayer' object has no attribute 'layers'
A merge layer should be called on a list of inputs.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 315, in build_and_compile
    classifier_.add(layer)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\merge.py", line 122, in call
    raise ValueError('A merge layer should be called on a list of inputs.')
ValueError: A merge layer should be called on a list of inputs.
A merge layer should be called on a list of inputs.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 316, in build_and_compile
    classifier_.add(layer)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\merge.py", line 122, in call
    raise ValueError('A merge layer should be called on a list of inputs.')
ValueError: A merge layer should be called on a list of inputs.
'Functional' object has no attribute 'add'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 330, in build_and_compile
    effnb2_model.add(layers.GlobalAveragePooling2D())
AttributeError: 'Functional' object has no attribute 'add'
The added layer must be an instance of class Layer. Found: [<tensorflow.python.keras.engine.node.Node object at 0x0000022565681CA0>]
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 317, in build_and_compile
    effnb2_model.add(layer(layer.inbound_nodes))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 180, in add
    raise TypeError('The added layer must be '
TypeError: The added layer must be an instance of class Layer. Found: [<tensorflow.python.keras.engine.node.Node object at 0x0000022565681CA0>]
Attempt to convert a value (<tensorflow.python.keras.engine.node.Node object at 0x0000024FD909A6D0>) with an unsupported type (<class 'tensorflow.python.keras.engine.node.Node'>) to a Tensor.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 317, in build_and_compile
    effnb2_model(layer(layer.inbound_nodes))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\preprocessing\image_preprocessing.py", line 329, in call
    return math_ops.cast(inputs, dtype) * scale + offset
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 923, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1525, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 339, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 264, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 276, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 98, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Attempt to convert a value (<tensorflow.python.keras.engine.node.Node object at 0x0000024FD909A6D0>) with an unsupported type (<class 'tensorflow.python.keras.engine.node.Node'>) to a Tensor.
'Functional' object is not subscriptable
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 312, in build_and_compile
    for inputs, outputs in classifier_pretrained.layers[: -1], classifier_pretrained[1:]:
TypeError: 'Functional' object is not subscriptable
'InputLayer' object is not iterable
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 316, in build_and_compile
    inputs = layers.Input(layer)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_layer.py", line 311, in Input
    input_layer = InputLayer(**input_layer_config)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_layer.py", line 150, in __init__
    batch_input_shape = (batch_size,) + tuple(input_shape)
TypeError: 'InputLayer' object is not iterable
Attempt to convert a value (<tensorflow.python.keras.engine.input_layer.InputLayer object at 0x000001F7115C3B80>) with an unsupported type (<class 'tensorflow.python.keras.engine.input_layer.InputLayer'>) to a Tensor.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 319, in build_and_compile
    x = layer(x)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\preprocessing\image_preprocessing.py", line 329, in call
    return math_ops.cast(inputs, dtype) * scale + offset
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 923, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1525, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 339, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 264, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 276, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 98, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Attempt to convert a value (<tensorflow.python.keras.engine.input_layer.InputLayer object at 0x000001F7115C3B80>) with an unsupported type (<class 'tensorflow.python.keras.engine.input_layer.InputLayer'>) to a Tensor.
Attempt to convert a value (<tensorflow.python.keras.engine.sequential.Sequential object at 0x0000021A63502040>) with an unsupported type (<class 'tensorflow.python.keras.engine.sequential.Sequential'>) to a Tensor.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 319, in build_and_compile
    x = layer(x)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\preprocessing\image_preprocessing.py", line 329, in call
    return math_ops.cast(inputs, dtype) * scale + offset
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 923, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1525, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 339, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 264, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 276, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 98, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Attempt to convert a value (<tensorflow.python.keras.engine.sequential.Sequential object at 0x0000021A63502040>) with an unsupported type (<class 'tensorflow.python.keras.engine.sequential.Sequential'>) to a Tensor.
Attempt to convert a value (<tensorflow.python.keras.engine.base_layer.Layer object at 0x000002C216D16070>) with an unsupported type (<class 'tensorflow.python.keras.engine.base_layer.Layer'>) to a Tensor.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 319, in build_and_compile
    x = layer(x)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\preprocessing\image_preprocessing.py", line 329, in call
    return math_ops.cast(inputs, dtype) * scale + offset
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 923, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1525, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 339, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 264, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 276, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 98, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Attempt to convert a value (<tensorflow.python.keras.engine.base_layer.Layer object at 0x000002C216D16070>) with an unsupported type (<class 'tensorflow.python.keras.engine.base_layer.Layer'>) to a Tensor.
'InputLayer' object is not iterable
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 316, in build_and_compile
    inputs = tf.keras.Input(layer)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_layer.py", line 311, in Input
    input_layer = InputLayer(**input_layer_config)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_layer.py", line 150, in __init__
    batch_input_shape = (batch_size,) + tuple(input_shape)
TypeError: 'InputLayer' object is not iterable
Error converting shape to a TensorShape: Dimension value must be integer or None or have an __index__ method, got value '(None, 260, 260, 3)' with type '<class 'tuple'>'.
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\eager\execute.py", line 211, in make_shape
    shape = tensor_shape.as_shape(v)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1235, in as_shape
    return TensorShape(shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 756, in __init__
    self._dims = [Dimension(d) for d in dims]
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 756, in <listcomp>
    self._dims = [Dimension(d) for d in dims]
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 201, in __init__
    six.raise_from(
  File "<string>", line 3, in raise_from
TypeError: Dimension value must be integer or None or have an __index__ method, got value '(None, 260, 260, 3)' with type '<class 'tuple'>'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 316, in build_and_compile
    inputs = tf.keras.Input(shape=layer.input_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_layer.py", line 311, in Input
    input_layer = InputLayer(**input_layer_config)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_layer.py", line 155, in __init__
    input_tensor = backend.placeholder(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 1227, in placeholder
    x = array_ops.placeholder(dtype, shape=shape, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\array_ops.py", line 3121, in placeholder
    return gen_array_ops.placeholder(dtype=dtype, shape=shape, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 6808, in placeholder
    shape = _execute.make_shape(shape, "shape")
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\eager\execute.py", line 213, in make_shape
    raise TypeError("Error converting %s to a TensorShape: %s." % (arg_name, e))
TypeError: Error converting shape to a TensorShape: Dimension value must be integer or None or have an __index__ method, got value '(None, 260, 260, 3)' with type '<class 'tuple'>'.
Attempt to convert a value (<tensorflow.python.keras.engine.input_layer.InputLayer object at 0x0000021B31B21B80>) with an unsupported type (<class 'tensorflow.python.keras.engine.input_layer.InputLayer'>) to a Tensor.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 318, in build_and_compile
    x = layer(x)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\preprocessing\image_preprocessing.py", line 329, in call
    return math_ops.cast(inputs, dtype) * scale + offset
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 923, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1525, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 339, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 264, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 276, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 98, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Attempt to convert a value (<tensorflow.python.keras.engine.input_layer.InputLayer object at 0x0000021B31B21B80>) with an unsupported type (<class 'tensorflow.python.keras.engine.input_layer.InputLayer'>) to a Tensor.
Please provide to Input either a `shape` or a `tensor` argument. Note that `shape` does not include the batch dimension.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 316, in build_and_compile
    x = layer(tf.keras.Input())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_layer.py", line 298, in Input
    raise ValueError('Please provide to Input either a `shape`'
ValueError: Please provide to Input either a `shape` or a `tensor` argument. Note that `shape` does not include the batch dimension.
Please provide to Input either a `shape` or a `tensor` argument. Note that `shape` does not include the batch dimension.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 316, in build_and_compile
    x = layer(tf.keras.Input(shape=None))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\input_layer.py", line 298, in Input
    raise ValueError('Please provide to Input either a `shape`'
ValueError: Please provide to Input either a `shape` or a `tensor` argument. Note that `shape` does not include the batch dimension.
A merge layer should be called on a list of inputs.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 318, in build_and_compile
    x = layer(x)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\merge.py", line 122, in call
    raise ValueError('A merge layer should be called on a list of inputs.')
ValueError: A merge layer should be called on a list of inputs.
Attempt to convert a value (<tensorflow.python.keras.engine.node.Node object at 0x0000029333362CA0>) with an unsupported type (<class 'tensorflow.python.keras.engine.node.Node'>) to a Tensor.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 319, in build_and_compile
    x = layer(previous_layer.inbound_nodes)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\preprocessing\image_preprocessing.py", line 329, in call
    return math_ops.cast(inputs, dtype) * scale + offset
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 923, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1525, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 339, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 264, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 276, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 98, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Attempt to convert a value (<tensorflow.python.keras.engine.node.Node object at 0x0000029333362CA0>) with an unsupported type (<class 'tensorflow.python.keras.engine.node.Node'>) to a Tensor.
'list' object is not callable
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 319, in build_and_compile
    x = layer(previous_layer.inbound_nodes(x))
TypeError: 'list' object is not callable
'Node' object is not callable
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 319, in build_and_compile
    x = layer([node(x) for node in layer.inbound_nodes])
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 319, in <listcomp>
    x = layer([node(x) for node in layer.inbound_nodes])
TypeError: 'Node' object is not callable
A merge layer should be called on a list of inputs.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 319, in build_and_compile
    x = layer(x)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\merge.py", line 122, in call
    raise ValueError('A merge layer should be called on a list of inputs.')
ValueError: A merge layer should be called on a list of inputs.
Shapes (3, 3, 3, 32) and (3,) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 344, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (3, 3, 3, 32) and (3,) are incompatible
Shapes (1408, 2) and (1408, 4) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 344, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (1408, 2) and (1408, 4) are incompatible
Mixing different tf.distribute.Strategy objects: <tensorflow.python.distribute.mirrored_strategy.MirroredStrategy object at 0x000001A10FCD8EB0> is not <tensorflow.python.distribute.mirrored_strategy.MirroredStrategy object at 0x000001A10FCFFBE0>
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 89, in build_and_compile
    with local_strategy.scope():
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 387, in __enter__
    _require_cross_replica_or_default_context_extended(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 309, in _require_cross_replica_or_default_context_extended
    _wrong_strategy_scope(strategy, context)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 322, in _wrong_strategy_scope
    raise RuntimeError(
RuntimeError: Mixing different tf.distribute.Strategy objects: <tensorflow.python.distribute.mirrored_strategy.MirroredStrategy object at 0x000001A10FCD8EB0> is not <tensorflow.python.distribute.mirrored_strategy.MirroredStrategy object at 0x000001A10FCFFBE0>
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 407, in build_and_compile
    model_architecture_review = model_architecture.analize(''.join([local_model_name, type_of_model,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 407, in build_and_compile
    model_architecture_review = model_architecture.analize(''.join([local_model_name, type_of_model,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 402, in build_and_compile
    print('model architecture saved')
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 402, in build_and_compile
    print('model architecture saved')
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 402, in build_and_compile
    print('model architecture saved')
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 386, in build_and_compile
    return False
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 407, in build_and_compile
    model_architecture_review = model_architecture.analize(''.join([local_model_name, type_of_model,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 410, in build_and_compile
    return classifier_
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 378, in build_and_compile
    model_architecture_review = model_architecture.analize(''.join([local_model_name, type_of_model,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 360, in build_and_compile
    classifier_.summary()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
pop from empty list
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 357, in build_and_compile
    classifier_.compile(optimizer=optimizer_function, loss=losses_list, metrics=metrics_list)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 429, in __exit__
    _pop_per_thread_mode()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribution_strategy_context.py", line 65, in _pop_per_thread_mode
    ops.get_default_graph()._distribution_strategy_stack.pop(-1)  # pylint: disable=protected-access
IndexError: pop from empty list
kl_divergence() missing 2 required positional arguments: 'y_true' and 'y_pred'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 156, in build_and_compile
    losses_list.append(losses.KLD())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
TypeError: kl_divergence() missing 2 required positional arguments: 'y_true' and 'y_pred'
kl_divergence() missing 2 required positional arguments: 'y_true' and 'y_pred'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 156, in build_and_compile
    losses_list.append(losses.KLD())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
TypeError: kl_divergence() missing 2 required positional arguments: 'y_true' and 'y_pred'
Shapes (3, 3, 3, 32) and (1, 1, 32, 16) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 343, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 699, in assign
    return values_util.on_write_assign(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values_util.py", line 33, in on_write_assign
    return var._update(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 837, in _update
    return self._update_cross_replica(update_fn, value, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 792, in _update_cross_replica
    return self.distribute_strategy.extended.update(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 2476, in update
    return self._update(var, fn, args, kwargs, group)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\mirrored_strategy.py", line 671, in _update
    fn(v, *distribute_utils.select_replica_mirrored(i, args),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 565, in wrapper
    return func(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values_util.py", line 32, in <lambda>
    assign_fn = lambda var, *a, **kw: var.assign(*a, **kw)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (3, 3, 3, 32) and (1, 1, 32, 16) are incompatible
Shapes (3, 3, 3, 32) and (1, 1, 32, 16) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 343, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 699, in assign
    return values_util.on_write_assign(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values_util.py", line 33, in on_write_assign
    return var._update(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 837, in _update
    return self._update_cross_replica(update_fn, value, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 792, in _update_cross_replica
    return self.distribute_strategy.extended.update(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 2476, in update
    return self._update(var, fn, args, kwargs, group)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\mirrored_strategy.py", line 671, in _update
    fn(v, *distribute_utils.select_replica_mirrored(i, args),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 565, in wrapper
    return func(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values_util.py", line 32, in <lambda>
    assign_fn = lambda var, *a, **kw: var.assign(*a, **kw)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (3, 3, 3, 32) and (1, 1, 32, 16) are incompatible
Shapes (3, 3, 3, 32) and (1, 1, 32, 16) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 343, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 699, in assign
    return values_util.on_write_assign(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values_util.py", line 33, in on_write_assign
    return var._update(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 837, in _update
    return self._update_cross_replica(update_fn, value, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 792, in _update_cross_replica
    return self.distribute_strategy.extended.update(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 2476, in update
    return self._update(var, fn, args, kwargs, group)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\mirrored_strategy.py", line 671, in _update
    fn(v, *distribute_utils.select_replica_mirrored(i, args),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 565, in wrapper
    return func(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values_util.py", line 32, in <lambda>
    assign_fn = lambda var, *a, **kw: var.assign(*a, **kw)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (3, 3, 3, 32) and (1, 1, 32, 16) are incompatible
Shapes (3, 3, 3, 32) and (1, 1, 32, 16) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 343, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 699, in assign
    return values_util.on_write_assign(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values_util.py", line 33, in on_write_assign
    return var._update(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 837, in _update
    return self._update_cross_replica(update_fn, value, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 792, in _update_cross_replica
    return self.distribute_strategy.extended.update(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 2476, in update
    return self._update(var, fn, args, kwargs, group)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\mirrored_strategy.py", line 671, in _update
    fn(v, *distribute_utils.select_replica_mirrored(i, args),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 565, in wrapper
    return func(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values_util.py", line 32, in <lambda>
    assign_fn = lambda var, *a, **kw: var.assign(*a, **kw)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (3, 3, 3, 32) and (1, 1, 32, 16) are incompatible
Loss scaling is not supported with the tf.distribute.Strategy: CentralStorageStrategy. Try using a different Strategy, e.g. a MirroredStrategy
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 136, in build_and_compile
    optimizer_function = tf.train.experimental.enable_mixed_precision_graph_rewrite(optimizer_function)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 205, in enable_mixed_precision_graph_rewrite
    return _enable_mixed_precision_graph_rewrite_base(opt, loss_scale,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 345, in _enable_mixed_precision_graph_rewrite_base
    opt = _wrap_optimizer(opt, loss_scale, use_v1_behavior=use_v1_behavior)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\experimental\mixed_precision.py", line 54, in _wrap_optimizer
    return wrapper_cls(opt, loss_scale)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\mixed_precision\experimental\loss_scale_optimizer.py", line 260, in __init__
    self._raise_if_strategy_unsupported()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\mixed_precision\experimental\loss_scale_optimizer.py", line 453, in _raise_if_strategy_unsupported
    raise ValueError('Loss scaling is not supported with the '
ValueError: Loss scaling is not supported with the tf.distribute.Strategy: CentralStorageStrategy. Try using a different Strategy, e.g. a MirroredStrategy
'use_bias_always'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 319, in build_and_compile
    if local_settings['nof_classes'] == 2 or local_settings['use_bias_always'] == 'True':
KeyError: 'use_bias_always'
Shapes (3, 3, 3, 32) and (1, 1, 32, 16) are incompatible
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 343, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2218, in load_weights
    hdf5_format.load_weights_from_hdf5_group(f, self.layers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 709, in load_weights_from_hdf5_group
    K.batch_set_value(weight_value_tuples)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\backend.py", line 3580, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype(x)))
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 699, in assign
    return values_util.on_write_assign(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values_util.py", line 33, in on_write_assign
    return var._update(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 837, in _update
    return self._update_cross_replica(update_fn, value, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values.py", line 792, in _update_cross_replica
    return self.distribute_strategy.extended.update(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\distribute_lib.py", line 2476, in update
    return self._update(var, fn, args, kwargs, group)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\mirrored_strategy.py", line 671, in _update
    fn(v, *distribute_utils.select_replica_mirrored(i, args),
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 565, in wrapper
    return func(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\distribute\values_util.py", line 32, in <lambda>
    assign_fn = lambda var, *a, **kw: var.assign(*a, **kw)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\resource_variable_ops.py", line 860, in assign
    self._shape.assert_is_compatible_with(value_tensor.shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\tensor_shape.py", line 1134, in assert_is_compatible_with
    raise ValueError("Shapes %s and %s are incompatible" % (self, other))
ValueError: Shapes (3, 3, 3, 32) and (1, 1, 32, 16) are incompatible
Unable to open file (unable to open file: name = './5.0_MODELS_DIR/old2_7_layers_CNN__group_0__EfficientNetB2_2020-08-11_weights.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 343, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2211, in load_weights
    with h5py.File(filepath, 'r') as f:
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\h5py\_hl\files.py", line 406, in __init__
    fid = make_fid(name, mode, userblock_size,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\h5py\_hl\files.py", line 173, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py\_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py\_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py\h5f.pyx", line 88, in h5py.h5f.open
OSError: Unable to open file (unable to open file: name = './5.0_MODELS_DIR/old2_7_layers_CNN__group_0__EfficientNetB2_2020-08-11_weights.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
The input must have 3 channels; got `input_shape=(260, 260, 1)`
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 304, in build_and_compile
    classifier_pretrained = tf.keras.applications.EfficientNetB2(include_top=False, weights='imagenet',
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 579, in EfficientNetB2
    return EfficientNet(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 283, in EfficientNet
    input_shape = imagenet_utils.obtain_input_shape(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\imagenet_utils.py", line 365, in obtain_input_shape
    raise ValueError('The input must have 3 channels; got '
ValueError: The input must have 3 channels; got `input_shape=(260, 260, 1)`
The input must have 3 channels; got `input_shape=(260, 260, 1)`
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 304, in build_and_compile
    classifier_pretrained = tf.keras.applications.EfficientNetB2(include_top=False, weights='imagenet',
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 579, in EfficientNetB2
    return EfficientNet(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 283, in EfficientNet
    input_shape = imagenet_utils.obtain_input_shape(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\imagenet_utils.py", line 365, in obtain_input_shape
    raise ValueError('The input must have 3 channels; got '
ValueError: The input must have 3 channels; got `input_shape=(260, 260, 1)`
The input must have 3 channels; got `input_shape=(260, 260, 1)`
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 304, in build_and_compile
    classifier_pretrained = tf.keras.applications.EfficientNetB2(include_top=False, weights='imagenet',
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 579, in EfficientNetB2
    return EfficientNet(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 283, in EfficientNet
    input_shape = imagenet_utils.obtain_input_shape(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\imagenet_utils.py", line 365, in obtain_input_shape
    raise ValueError('The input must have 3 channels; got '
ValueError: The input must have 3 channels; got `input_shape=(260, 260, 1)`
The input must have 3 channels; got `input_shape=(260, 260, 1)`
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 304, in build_and_compile
    classifier_pretrained = tf.keras.applications.EfficientNetB2(include_top=False, weights='imagenet',
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 579, in EfficientNetB2
    return EfficientNet(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\efficientnet.py", line 283, in EfficientNet
    input_shape = imagenet_utils.obtain_input_shape(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\applications\imagenet_utils.py", line 365, in obtain_input_shape
    raise ValueError('The input must have 3 channels; got '
ValueError: The input must have 3 channels; got `input_shape=(260, 260, 1)`
name 'null' is not defined
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 313, in build_and_compile
    layer.batch_input_shape = [null, null, null, 1]
NameError: name 'null' is not defined
'InputLayer' object has no attribute 'batch_input_shape'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 313, in build_and_compile
    print(layer.batch_input_shape)
AttributeError: 'InputLayer' object has no attribute 'batch_input_shape'
'InputLayer' object has no attribute 'config'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 313, in build_and_compile
    print(layer.config.batch_input_shape)
AttributeError: 'InputLayer' object has no attribute 'config'
'InputLayer' object has no attribute 'config'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 314, in build_and_compile
    layer.config.batch_input_shape = [None, input_shape_y, input_shape_x, 1]
AttributeError: 'InputLayer' object has no attribute 'config'
Attempt to convert a value (<tensorflow.python.keras.layers.preprocessing.normalization.Normalization object at 0x000001B57B52CCD0>) with an unsupported type (<class 'tensorflow.python.keras.layers.preprocessing.normalization.Normalization'>) to a Tensor.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 316, in build_and_compile
    classifier_receptor = classifier_receptor(layer)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 986, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\preprocessing\image_preprocessing.py", line 329, in call
    return math_ops.cast(inputs, dtype) * scale + offset
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\util\dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\ops\math_ops.py", line 923, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\ops.py", line 1525, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 339, in _constant_tensor_conversion_function
    return constant(v, dtype=dtype, name=name)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 264, in constant
    return _constant_impl(value, dtype, shape, name, verify_shape=False,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 276, in _constant_impl
    return _constant_eager_impl(ctx, value, dtype, shape, verify_shape)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 301, in _constant_eager_impl
    t = convert_to_eager_tensor(value, ctx, dtype)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 98, in convert_to_eager_tensor
    return ops.EagerTensor(value, ctx.device_name, dtype)
ValueError: Attempt to convert a value (<tensorflow.python.keras.layers.preprocessing.normalization.Normalization object at 0x000001B57B52CCD0>) with an unsupported type (<class 'tensorflow.python.keras.layers.preprocessing.normalization.Normalization'>) to a Tensor.
'NoneType' object has no attribute 'add'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 316, in build_and_compile
    classifier_receptor = classifier_receptor.add(layer)
AttributeError: 'NoneType' object has no attribute 'add'
A merge layer should be called on a list of inputs.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 316, in build_and_compile
    classifier_receptor.add(layer)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\training\tracking\base.py", line 459, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\sequential.py", line 221, in add
    output_tensor = layer(self.outputs[0])
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 926, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 1118, in _functional_construction_call
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\layers\merge.py", line 122, in call
    raise ValueError('A merge layer should be called on a list of inputs.')
ValueError: A merge layer should be called on a list of inputs.
Unable to load weights saved in HDF5 format into a subclassed Model which has not created its variables yet. Call the Model first, then load the weights.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 349, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2206, in load_weights
    raise ValueError(
ValueError: Unable to load weights saved in HDF5 format into a subclassed Model which has not created its variables yet. Call the Model first, then load the weights.
Unable to load weights saved in HDF5 format into a subclassed Model which has not created its variables yet. Call the Model first, then load the weights.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 350, in build_and_compile
    classifier_.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2206, in load_weights
    raise ValueError(
ValueError: Unable to load weights saved in HDF5 format into a subclassed Model which has not created its variables yet. Call the Model first, then load the weights.
This model has not yet been built. Build the model first by calling `build()` or calling `fit()` with some data, or specify an `input_shape` argument in the first layer(s) for automatic build.
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 365, in build_and_compile
    classifier_.summary()
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2358, in summary
    raise ValueError('This model has not yet been built. '
ValueError: This model has not yet been built. Build the model first by calling `build()` or calling `fit()` with some data, or specify an `input_shape` argument in the first layer(s) for automatic build.
Can't set the attribute "input", likely because it conflicts with an existing read-only @property of the object. Please choose a different name.
Traceback (most recent call last):
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2767, in __setattr__
    super(tracking.AutoTrackable, self).__setattr__(name, value)
AttributeError: can't set attribute

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 316, in build_and_compile
    layer.input = [None, input_shape_y, input_shape_x, nof_channels]
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\base_layer.py", line 2769, in __setattr__
    raise AttributeError(
AttributeError: Can't set the attribute "input", likely because it conflicts with an existing read-only @property of the object. Please choose a different name.
Layer #4 (named "stem_conv"), weight MirroredVariable:{
  0: <tf.Variable 'stem_conv/kernel:0' shape=(3, 3, 1, 32) dtype=float32, numpy=
array([[[[-0.15908475, -0.08071179,  0.07409947, -0.06247768,
           0.04011817, -0.09125746, -0.15161334, -0.03586618,
          -0.0657851 ,  0.16479218, -0.13055883, -0.1460049 ,
          -0.09677344,  0.10869554, -0.061917  , -0.03712202,
           0.03420996, -0.06713159, -0.02004733,  0.10771288,
          -0.16052873,  0.130093  , -0.02695997,  0.05720127,
           0.03078581, -0.08266558, -0.13624308, -0.00268792,
           0.0080975 ,  0.04726624, -0.06604604, -0.10394514]],

        [[ 0.03117656,  0.0119303 , -0.04300012,  0.01471129,
           0.13153483, -0.03209322, -0.10868961,  0.06750296,
           0.02445257, -0.01425091,  0.01968663,  0.17789891,
           0.06112015,  0.03245781,  0.02919878,  0.1525267 ,
          -0.11003619, -0.09903945, -0.02056165, -0.11709912,
          -0.02845524,  0.02097982,  0.12417495,  0.02055771,
           0.12214914,  0.04126379,  0.04275472,  0.03619433,
          -0.11000339, -0.10830637,  0.09524043,  0.13907394]],

        [[ 0.03422992, -0.08264093, -0.12241272, -0.02789521,
          -0.01229551, -0.05568821, -0.10168324, -0.0012175 ,
          -0.02140321, -0.07739627,  0.01749389,  0.14966555,
          -0.11225665, -0.03467224, -0.06149288,  0.04519638,
          -0.06111501,  0.01464749, -0.05781964, -0.0473991 ,
          -0.0772455 , -0.1275977 , -0.04503163, -0.04028821,
           0.1749694 ,  0.02864096, -0.05264106, -0.09474841,
          -0.01546138, -0.00345561, -0.08736887, -0.04951323]]],


       [[[-0.0394113 , -0.02001446, -0.02347835, -0.01302849,
          -0.01927429, -0.05919275, -0.08674175, -0.03446845,
           0.00407795, -0.0758987 , -0.01017859,  0.06276064,
          -0.06358708,  0.03993477, -0.03774687, -0.02055199,
           0.03158735,  0.087054  ,  0.16648121, -0.00536158,
          -0.05386068, -0.15756555,  0.08762542, -0.01779886,
          -0.10052773,  0.03063828, -0.01148973,  0.00649657,
           0.05995976,  0.02418776, -0.01093092,  0.16470197]],

        [[-0.08045219, -0.00809984, -0.01971079, -0.07882412,
          -0.01739538, -0.11050083,  0.003766  ,  0.13953428,
          -0.09044169,  0.02885578, -0.06786563, -0.09661706,
          -0.03912279, -0.01578107, -0.05635451, -0.02637432,
          -0.03530358, -0.10722693,  0.07660702,  0.08047156,
          -0.0867371 , -0.10080294, -0.08149062, -0.02770432,
           0.06689166,  0.08158533,  0.08474493,  0.00500868,
           0.07111192, -0.14800231, -0.03663539,  0.00198596]],

        [[-0.0424748 ,  0.07361127, -0.06475154, -0.06221928,
          -0.03076765, -0.14067112,  0.08423981,  0.07819743,
          -0.08882995,  0.09867649, -0.12639302, -0.04166646,
          -0.05626656, -0.13688871, -0.07505874,  0.06116931,
           0.03361221,  0.08974266,  0.06206489, -0.03181355,
           0.0570679 ,  0.08838714, -0.03661262,  0.01113139,
           0.08155442,  0.15928562, -0.07381677, -0.05720161,
           0.13991529,  0.0980944 ,  0.05122304,  0.08026548]]],


       [[[ 0.12636104,  0.05750145, -0.01005538, -0.03071745,
           0.01698976,  0.08106054, -0.06224626, -0.17386228,
           0.03712535, -0.06023448,  0.07933293,  0.10796501,
          -0.13929498,  0.06153239, -0.10310709,  0.01980263,
          -0.01943127, -0.10706807,  0.05017132, -0.04067387,
          -0.01992529, -0.00660479, -0.03451211, -0.12434142,
          -0.05164358,  0.0051224 ,  0.02080335,  0.06750087,
          -0.00498214,  0.10255123, -0.15143251,  0.0645102 ]],

        [[ 0.01453486,  0.00491085,  0.06862168,  0.03416253,
           0.01605247, -0.07562157, -0.07180563, -0.13716915,
           0.15307476, -0.09023835, -0.09106499, -0.04794006,
          -0.00719273, -0.06249175, -0.00966874,  0.05676702,
          -0.18064468, -0.13021828, -0.0438131 , -0.00816091,
           0.10699803,  0.00413825, -0.06262738, -0.06361753,
          -0.05947974,  0.1467095 ,  0.11275721,  0.02784064,
           0.0676106 ,  0.18729524,  0.09203591,  0.04050779]],

        [[-0.14375879, -0.03840523, -0.1093002 ,  0.04625173,
           0.02782219,  0.04954538, -0.02278101, -0.12086181,
          -0.17240652,  0.07648339,  0.06790696, -0.05019384,
           0.12434982, -0.12096336, -0.07425793,  0.01444912,
          -0.00098893,  0.05244982, -0.14870255, -0.13755363,
           0.1272023 , -0.11545613, -0.1303058 , -0.07788929,
           0.18327443, -0.10473828,  0.04105451,  0.08357695,
          -0.13720049,  0.0901923 ,  0.02446061, -0.07074978]]]],
      dtype=float32)>,
  1: <tf.Variable 'stem_conv/kernel/replica_1:0' shape=(3, 3, 1, 32) dtype=float32, numpy=
array([[[[-0.15908475, -0.08071179,  0.07409947, -0.06247768,
           0.04011817, -0.09125746, -0.15161334, -0.03586618,
          -0.0657851 ,  0.16479218, -0.13055883, -0.1460049 ,
          -0.09677344,  0.10869554, -0.061917  , -0.03712202,
           0.03420996, -0.06713159, -0.02004733,  0.10771288,
          -0.16052873,  0.130093  , -0.02695997,  0.05720127,
           0.03078581, -0.08266558, -0.13624308, -0.00268792,
           0.0080975 ,  0.04726624, -0.06604604, -0.10394514]],

        [[ 0.03117656,  0.0119303 , -0.04300012,  0.01471129,
           0.13153483, -0.03209322, -0.10868961,  0.06750296,
           0.02445257, -0.01425091,  0.01968663,  0.17789891,
           0.06112015,  0.03245781,  0.02919878,  0.1525267 ,
          -0.11003619, -0.09903945, -0.02056165, -0.11709912,
          -0.02845524,  0.02097982,  0.12417495,  0.02055771,
           0.12214914,  0.04126379,  0.04275472,  0.03619433,
          -0.11000339, -0.10830637,  0.09524043,  0.13907394]],

        [[ 0.03422992, -0.08264093, -0.12241272, -0.02789521,
          -0.01229551, -0.05568821, -0.10168324, -0.0012175 ,
          -0.02140321, -0.07739627,  0.01749389,  0.14966555,
          -0.11225665, -0.03467224, -0.06149288,  0.04519638,
          -0.06111501,  0.01464749, -0.05781964, -0.0473991 ,
          -0.0772455 , -0.1275977 , -0.04503163, -0.04028821,
           0.1749694 ,  0.02864096, -0.05264106, -0.09474841,
          -0.01546138, -0.00345561, -0.08736887, -0.04951323]]],


       [[[-0.0394113 , -0.02001446, -0.02347835, -0.01302849,
          -0.01927429, -0.05919275, -0.08674175, -0.03446845,
           0.00407795, -0.0758987 , -0.01017859,  0.06276064,
          -0.06358708,  0.03993477, -0.03774687, -0.02055199,
           0.03158735,  0.087054  ,  0.16648121, -0.00536158,
          -0.05386068, -0.15756555,  0.08762542, -0.01779886,
          -0.10052773,  0.03063828, -0.01148973,  0.00649657,
           0.05995976,  0.02418776, -0.01093092,  0.16470197]],

        [[-0.08045219, -0.00809984, -0.01971079, -0.07882412,
          -0.01739538, -0.11050083,  0.003766  ,  0.13953428,
          -0.09044169,  0.02885578, -0.06786563, -0.09661706,
          -0.03912279, -0.01578107, -0.05635451, -0.02637432,
          -0.03530358, -0.10722693,  0.07660702,  0.08047156,
          -0.0867371 , -0.10080294, -0.08149062, -0.02770432,
           0.06689166,  0.08158533,  0.08474493,  0.00500868,
           0.07111192, -0.14800231, -0.03663539,  0.00198596]],

        [[-0.0424748 ,  0.07361127, -0.06475154, -0.06221928,
          -0.03076765, -0.14067112,  0.08423981,  0.07819743,
          -0.08882995,  0.09867649, -0.12639302, -0.04166646,
          -0.05626656, -0.13688871, -0.07505874,  0.06116931,
           0.03361221,  0.08974266,  0.06206489, -0.03181355,
           0.0570679 ,  0.08838714, -0.03661262,  0.01113139,
           0.08155442,  0.15928562, -0.07381677, -0.05720161,
           0.13991529,  0.0980944 ,  0.05122304,  0.08026548]]],


       [[[ 0.12636104,  0.05750145, -0.01005538, -0.03071745,
           0.01698976,  0.08106054, -0.06224626, -0.17386228,
           0.03712535, -0.06023448,  0.07933293,  0.10796501,
          -0.13929498,  0.06153239, -0.10310709,  0.01980263,
          -0.01943127, -0.10706807,  0.05017132, -0.04067387,
          -0.01992529, -0.00660479, -0.03451211, -0.12434142,
          -0.05164358,  0.0051224 ,  0.02080335,  0.06750087,
          -0.00498214,  0.10255123, -0.15143251,  0.0645102 ]],

        [[ 0.01453486,  0.00491085,  0.06862168,  0.03416253,
           0.01605247, -0.07562157, -0.07180563, -0.13716915,
           0.15307476, -0.09023835, -0.09106499, -0.04794006,
          -0.00719273, -0.06249175, -0.00966874,  0.05676702,
          -0.18064468, -0.13021828, -0.0438131 , -0.00816091,
           0.10699803,  0.00413825, -0.06262738, -0.06361753,
          -0.05947974,  0.1467095 ,  0.11275721,  0.02784064,
           0.0676106 ,  0.18729524,  0.09203591,  0.04050779]],

        [[-0.14375879, -0.03840523, -0.1093002 ,  0.04625173,
           0.02782219,  0.04954538, -0.02278101, -0.12086181,
          -0.17240652,  0.07648339,  0.06790696, -0.05019384,
           0.12434982, -0.12096336, -0.07425793,  0.01444912,
          -0.00098893,  0.05244982, -0.14870255, -0.13755363,
           0.1272023 , -0.11545613, -0.1303058 , -0.07788929,
           0.18327443, -0.10473828,  0.04105451,  0.08357695,
          -0.13720049,  0.0901923 ,  0.02446061, -0.07074978]]]],
      dtype=float32)>
} has shape (3, 3, 1, 32), but the saved weight has shape (32, 3, 3, 3).
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 320, in build_and_compile
    classifier_receptor.load_weights(''.join([local_settings['models_path'],
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 2215, in load_weights
    hdf5_format.load_weights_from_hdf5_group_by_name(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\saving\hdf5_format.py", line 782, in load_weights_from_hdf5_group_by_name
    raise ValueError('Layer #' + str(k) +' (named "' + layer.name +
ValueError: Layer #4 (named "stem_conv"), weight MirroredVariable:{
  0: <tf.Variable 'stem_conv/kernel:0' shape=(3, 3, 1, 32) dtype=float32, numpy=
array([[[[-0.15908475, -0.08071179,  0.07409947, -0.06247768,
           0.04011817, -0.09125746, -0.15161334, -0.03586618,
          -0.0657851 ,  0.16479218, -0.13055883, -0.1460049 ,
          -0.09677344,  0.10869554, -0.061917  , -0.03712202,
           0.03420996, -0.06713159, -0.02004733,  0.10771288,
          -0.16052873,  0.130093  , -0.02695997,  0.05720127,
           0.03078581, -0.08266558, -0.13624308, -0.00268792,
           0.0080975 ,  0.04726624, -0.06604604, -0.10394514]],

        [[ 0.03117656,  0.0119303 , -0.04300012,  0.01471129,
           0.13153483, -0.03209322, -0.10868961,  0.06750296,
           0.02445257, -0.01425091,  0.01968663,  0.17789891,
           0.06112015,  0.03245781,  0.02919878,  0.1525267 ,
          -0.11003619, -0.09903945, -0.02056165, -0.11709912,
          -0.02845524,  0.02097982,  0.12417495,  0.02055771,
           0.12214914,  0.04126379,  0.04275472,  0.03619433,
          -0.11000339, -0.10830637,  0.09524043,  0.13907394]],

        [[ 0.03422992, -0.08264093, -0.12241272, -0.02789521,
          -0.01229551, -0.05568821, -0.10168324, -0.0012175 ,
          -0.02140321, -0.07739627,  0.01749389,  0.14966555,
          -0.11225665, -0.03467224, -0.06149288,  0.04519638,
          -0.06111501,  0.01464749, -0.05781964, -0.0473991 ,
          -0.0772455 , -0.1275977 , -0.04503163, -0.04028821,
           0.1749694 ,  0.02864096, -0.05264106, -0.09474841,
          -0.01546138, -0.00345561, -0.08736887, -0.04951323]]],


       [[[-0.0394113 , -0.02001446, -0.02347835, -0.01302849,
          -0.01927429, -0.05919275, -0.08674175, -0.03446845,
           0.00407795, -0.0758987 , -0.01017859,  0.06276064,
          -0.06358708,  0.03993477, -0.03774687, -0.02055199,
           0.03158735,  0.087054  ,  0.16648121, -0.00536158,
          -0.05386068, -0.15756555,  0.08762542, -0.01779886,
          -0.10052773,  0.03063828, -0.01148973,  0.00649657,
           0.05995976,  0.02418776, -0.01093092,  0.16470197]],

        [[-0.08045219, -0.00809984, -0.01971079, -0.07882412,
          -0.01739538, -0.11050083,  0.003766  ,  0.13953428,
          -0.09044169,  0.02885578, -0.06786563, -0.09661706,
          -0.03912279, -0.01578107, -0.05635451, -0.02637432,
          -0.03530358, -0.10722693,  0.07660702,  0.08047156,
          -0.0867371 , -0.10080294, -0.08149062, -0.02770432,
           0.06689166,  0.08158533,  0.08474493,  0.00500868,
           0.07111192, -0.14800231, -0.03663539,  0.00198596]],

        [[-0.0424748 ,  0.07361127, -0.06475154, -0.06221928,
          -0.03076765, -0.14067112,  0.08423981,  0.07819743,
          -0.08882995,  0.09867649, -0.12639302, -0.04166646,
          -0.05626656, -0.13688871, -0.07505874,  0.06116931,
           0.03361221,  0.08974266,  0.06206489, -0.03181355,
           0.0570679 ,  0.08838714, -0.03661262,  0.01113139,
           0.08155442,  0.15928562, -0.07381677, -0.05720161,
           0.13991529,  0.0980944 ,  0.05122304,  0.08026548]]],


       [[[ 0.12636104,  0.05750145, -0.01005538, -0.03071745,
           0.01698976,  0.08106054, -0.06224626, -0.17386228,
           0.03712535, -0.06023448,  0.07933293,  0.10796501,
          -0.13929498,  0.06153239, -0.10310709,  0.01980263,
          -0.01943127, -0.10706807,  0.05017132, -0.04067387,
          -0.01992529, -0.00660479, -0.03451211, -0.12434142,
          -0.05164358,  0.0051224 ,  0.02080335,  0.06750087,
          -0.00498214,  0.10255123, -0.15143251,  0.0645102 ]],

        [[ 0.01453486,  0.00491085,  0.06862168,  0.03416253,
           0.01605247, -0.07562157, -0.07180563, -0.13716915,
           0.15307476, -0.09023835, -0.09106499, -0.04794006,
          -0.00719273, -0.06249175, -0.00966874,  0.05676702,
          -0.18064468, -0.13021828, -0.0438131 , -0.00816091,
           0.10699803,  0.00413825, -0.06262738, -0.06361753,
          -0.05947974,  0.1467095 ,  0.11275721,  0.02784064,
           0.0676106 ,  0.18729524,  0.09203591,  0.04050779]],

        [[-0.14375879, -0.03840523, -0.1093002 ,  0.04625173,
           0.02782219,  0.04954538, -0.02278101, -0.12086181,
          -0.17240652,  0.07648339,  0.06790696, -0.05019384,
           0.12434982, -0.12096336, -0.07425793,  0.01444912,
          -0.00098893,  0.05244982, -0.14870255, -0.13755363,
           0.1272023 , -0.11545613, -0.1303058 , -0.07788929,
           0.18327443, -0.10473828,  0.04105451,  0.08357695,
          -0.13720049,  0.0901923 ,  0.02446061, -0.07074978]]]],
      dtype=float32)>,
  1: <tf.Variable 'stem_conv/kernel/replica_1:0' shape=(3, 3, 1, 32) dtype=float32, numpy=
array([[[[-0.15908475, -0.08071179,  0.07409947, -0.06247768,
           0.04011817, -0.09125746, -0.15161334, -0.03586618,
          -0.0657851 ,  0.16479218, -0.13055883, -0.1460049 ,
          -0.09677344,  0.10869554, -0.061917  , -0.03712202,
           0.03420996, -0.06713159, -0.02004733,  0.10771288,
          -0.16052873,  0.130093  , -0.02695997,  0.05720127,
           0.03078581, -0.08266558, -0.13624308, -0.00268792,
           0.0080975 ,  0.04726624, -0.06604604, -0.10394514]],

        [[ 0.03117656,  0.0119303 , -0.04300012,  0.01471129,
           0.13153483, -0.03209322, -0.10868961,  0.06750296,
           0.02445257, -0.01425091,  0.01968663,  0.17789891,
           0.06112015,  0.03245781,  0.02919878,  0.1525267 ,
          -0.11003619, -0.09903945, -0.02056165, -0.11709912,
          -0.02845524,  0.02097982,  0.12417495,  0.02055771,
           0.12214914,  0.04126379,  0.04275472,  0.03619433,
          -0.11000339, -0.10830637,  0.09524043,  0.13907394]],

        [[ 0.03422992, -0.08264093, -0.12241272, -0.02789521,
          -0.01229551, -0.05568821, -0.10168324, -0.0012175 ,
          -0.02140321, -0.07739627,  0.01749389,  0.14966555,
          -0.11225665, -0.03467224, -0.06149288,  0.04519638,
          -0.06111501,  0.01464749, -0.05781964, -0.0473991 ,
          -0.0772455 , -0.1275977 , -0.04503163, -0.04028821,
           0.1749694 ,  0.02864096, -0.05264106, -0.09474841,
          -0.01546138, -0.00345561, -0.08736887, -0.04951323]]],


       [[[-0.0394113 , -0.02001446, -0.02347835, -0.01302849,
          -0.01927429, -0.05919275, -0.08674175, -0.03446845,
           0.00407795, -0.0758987 , -0.01017859,  0.06276064,
          -0.06358708,  0.03993477, -0.03774687, -0.02055199,
           0.03158735,  0.087054  ,  0.16648121, -0.00536158,
          -0.05386068, -0.15756555,  0.08762542, -0.01779886,
          -0.10052773,  0.03063828, -0.01148973,  0.00649657,
           0.05995976,  0.02418776, -0.01093092,  0.16470197]],

        [[-0.08045219, -0.00809984, -0.01971079, -0.07882412,
          -0.01739538, -0.11050083,  0.003766  ,  0.13953428,
          -0.09044169,  0.02885578, -0.06786563, -0.09661706,
          -0.03912279, -0.01578107, -0.05635451, -0.02637432,
          -0.03530358, -0.10722693,  0.07660702,  0.08047156,
          -0.0867371 , -0.10080294, -0.08149062, -0.02770432,
           0.06689166,  0.08158533,  0.08474493,  0.00500868,
           0.07111192, -0.14800231, -0.03663539,  0.00198596]],

        [[-0.0424748 ,  0.07361127, -0.06475154, -0.06221928,
          -0.03076765, -0.14067112,  0.08423981,  0.07819743,
          -0.08882995,  0.09867649, -0.12639302, -0.04166646,
          -0.05626656, -0.13688871, -0.07505874,  0.06116931,
           0.03361221,  0.08974266,  0.06206489, -0.03181355,
           0.0570679 ,  0.08838714, -0.03661262,  0.01113139,
           0.08155442,  0.15928562, -0.07381677, -0.05720161,
           0.13991529,  0.0980944 ,  0.05122304,  0.08026548]]],


       [[[ 0.12636104,  0.05750145, -0.01005538, -0.03071745,
           0.01698976,  0.08106054, -0.06224626, -0.17386228,
           0.03712535, -0.06023448,  0.07933293,  0.10796501,
          -0.13929498,  0.06153239, -0.10310709,  0.01980263,
          -0.01943127, -0.10706807,  0.05017132, -0.04067387,
          -0.01992529, -0.00660479, -0.03451211, -0.12434142,
          -0.05164358,  0.0051224 ,  0.02080335,  0.06750087,
          -0.00498214,  0.10255123, -0.15143251,  0.0645102 ]],

        [[ 0.01453486,  0.00491085,  0.06862168,  0.03416253,
           0.01605247, -0.07562157, -0.07180563, -0.13716915,
           0.15307476, -0.09023835, -0.09106499, -0.04794006,
          -0.00719273, -0.06249175, -0.00966874,  0.05676702,
          -0.18064468, -0.13021828, -0.0438131 , -0.00816091,
           0.10699803,  0.00413825, -0.06262738, -0.06361753,
          -0.05947974,  0.1467095 ,  0.11275721,  0.02784064,
           0.0676106 ,  0.18729524,  0.09203591,  0.04050779]],

        [[-0.14375879, -0.03840523, -0.1093002 ,  0.04625173,
           0.02782219,  0.04954538, -0.02278101, -0.12086181,
          -0.17240652,  0.07648339,  0.06790696, -0.05019384,
           0.12434982, -0.12096336, -0.07425793,  0.01444912,
          -0.00098893,  0.05244982, -0.14870255, -0.13755363,
           0.1272023 , -0.11545613, -0.1303058 , -0.07788929,
           0.18327443, -0.10473828,  0.04105451,  0.08357695,
          -0.13720049,  0.0901923 ,  0.02446061, -0.07074978]]]],
      dtype=float32)>
} has shape (3, 3, 1, 32), but the saved weight has shape (32, 3, 3, 3).
Can't instantiate abstract class customized_metrics_bacc with abstract methods result, update_state
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 160, in build_and_compile
    losses_list.append(customized_metrics_bacc())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\metrics.py", line 163, in __new__
    obj = super(Metric, cls).__new__(cls)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\version_utils.py", line 66, in __new__
    return super(LayerVersionSelector, cls).__new__(cls)
TypeError: Can't instantiate abstract class customized_metrics_bacc with abstract methods result, update_state
__init__() got an unexpected keyword argument 'local_label_smoothing'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 168, in build_and_compile
    losses_list.append(customized_loss_t2(local_label_smoothing=label_smoothing))
TypeError: __init__() got an unexpected keyword argument 'local_label_smoothing'
__init__() got an unexpected keyword argument 'local_label_smoothing'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 168, in build_and_compile
    losses_list.append(customized_loss_t2(local_label_smoothing=label_smoothing))
TypeError: __init__() got an unexpected keyword argument 'local_label_smoothing'
Can't instantiate abstract class customized_metric_auc_roc with abstract methods result, update_state
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 179, in build_and_compile
    metrics_list.append(customized_metric_auc_roc())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\metrics.py", line 163, in __new__
    obj = super(Metric, cls).__new__(cls)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\version_utils.py", line 66, in __new__
    return super(LayerVersionSelector, cls).__new__(cls)
TypeError: Can't instantiate abstract class customized_metric_auc_roc with abstract methods result, update_state
Can't instantiate abstract class customized_metric_auc_roc with abstract methods result, update_state
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 178, in build_and_compile
    metrics_list.append(customized_metric_auc_roc())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\metrics.py", line 163, in __new__
    obj = super(Metric, cls).__new__(cls)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\keras\utils\version_utils.py", line 66, in __new__
    return super(LayerVersionSelector, cls).__new__(cls)
TypeError: Can't instantiate abstract class customized_metric_auc_roc with abstract methods result, update_state
in user code:


    TypeError: tf__customized_loss_t2() missing 2 required positional arguments: 'y_true_local' and 'y_pred_local'
Traceback (most recent call last):
  File "./5.2_CUSTOM_LIBRARY\custom_model_builder.py", line 183, in build_and_compile
    losses_list.append(customized_loss_t2())
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 786, in __call__
    result = self._call(*args, **kwds)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 829, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 702, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\eager\function.py", line 2883, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\eager\function.py", line 3240, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\eager\function.py", line 3092, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 986, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 606, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "C:\carpeta_p_pycharm\M5_kaggle_accuracy\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 973, in wrapper
    raise e.ag_error_metadata.to_exception(e)
TypeError: in user code:


    TypeError: tf__customized_loss_t2() missing 2 required positional arguments: 'y_true_local' and 'y_pred_local'

